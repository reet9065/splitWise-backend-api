# Expense Tracker API

## Description
This project is a backend API for an expense tracking application. The API allows users to create, update, and manage expenses, send OTP verification emails, and retrieve expense details.

## Folder Structure
The project's folder structure is as follows:
```
root
├── Controller
│ └── CreateExpenses.js
├── Models
│ ├── Enteries.js
│ ├── Expenses.js
│ ├── jwtToken.js
│ ├── Otp.js
│ └── UserSchema.js
├── routes
│ └── ExpensesRoutes.js
├── Services
│ ├── otpSender.js
│ ├── otpVerifier.js
│ └── Token.js
├── .env
├── index.js
├── package-lock.json
└── package.json
```


## Installation
1. **Clone the repository:**
   ```bash
   git clone <repository-url>
   cd <repository-directory>
   npm install
   
## Set up the enviroment variables
2. **Set the thiese variabel to your .env file:**
   ```.env
   PORT           = 3000
   SERVER_HOST    = 'http://localhost:3000'
   HOST_USER      = <YOUR EMAIL> # Email id for sending otp through email
   HOST_PASSWORD  = <PASWORD APP PASSWORD TO SEND EMAIL>
   DB_CONNECT_URL = "mongodb://localhost:27017/SplitWise"
   JWT_SECRET_KEY = <ANY SECRET KEY>
   
   
## START THE SERVER
3. **starting the server:**
  ```bash
    npm start
```    
# API Documentation

## Endpoints

### 1. Create User

- **URL:** `http://localhost:3000/CreateUser`
- **Method:** `POST`
- **Content-Type:** `application/json`

#### Request Body

The request body should be a JSON object with the following fields:

```json
{
  "name": "User Name",
  "email": "user@example.com",
  "phone": "1234567890"
}
```

#### Success Response

- **Code:** `200 OK`
- **Content:**

  ```json
  {
    "message": "Otp link sent to your email: user@example.com, Please verify your email"
  }


### 2. Verify Email

- **URL:** `http://localhost:3000/verifyemail?otp_id=<otp_id>&otp=<otp>`
- **Method:** `GET`
- **Content-Type:** `application/json`
- **Body:** None

#### Query Parameters

- **otp_id** (string): The unique identifier for the OTP request.
- **otp** (string): The OTP (One-Time Password) to verify the email.

#### Success Response

- **Code:** `200 OK`
- **Content:**

  ```json
  {
    "message": "Email verified successfully",
    "Session_token_id": "<TOKEN GENERATED BY SERVER>"
  }
  ```


### 3. Create Expense

- **URL:** `http://localhost:3000/api/expenses/create`
- **Method:** `POST`
- **Content-Type:** `application/json`

#### Request Body

The request body should be a JSON object with the following structure:

   ```json
    {
      "Header": {
        "token": "<USER TOKEN>"
      },
      "expensesName": "weekend getaway",
      "amount": 600,
      "splitType": "exact || equal || percentage",
      "description": "outing with friends",
      "participants": [
        {
          "email": "friend1@example.com",
          "amount": 200
        }
      ]
    }
   ```
   
 Success Response
Code: 200 OK

Content:

```json
{
  "_id": "<EXPENSE ID>",
  "payerEmail": "user@example.com",
  "expensesName": "weekend getaway",
  "totalAmount": 600,
  "splitType": "exact || equal || percentage",
  "description": "outing with friends",
  "participants": [
    {
      "email": "friend1@example.com",
      "amount": 200,
      "_id": "<PARTICIPANT ID>"
    }
  ],
  "upDateEnteries": ["<ENTRY ID>"],
  "__v": 0
}
```

### 4. Update Expense

- **URL:** `http://localhost:3000/api/expenses/update?id=<expense_id>`
- **Method:** `POST`
- **Content-Type:** `application/json`

#### Request Body

The request body should be a JSON object with the following structure:

   ```json
    {
      "Header": {
        "token": "<USER TOKEN>"
      },
      "amount": 2500,
      "participants": [
        {
          "email": "friend2@example.com",
          "amount": 1000 
        }
      ]
    }
  ```
  
  
Success Response
Code: 200 OK

Content:

```json
{
  "_id": "<EXPENSE ID>",
  "payerEmail": "user@example.com",
  "expensesName": "expense name",
  "totalAmount": 2900,
  "splitType": "exact",
  "description": "description",
  "participants": [
    {
      "email": "friend2@example.com",
      "amount": 1000,
      "_id": "<PARTICIPANT ID>"
    }
  ],
  "upDateEnteries": ["<ENTRY ID>"],
  "__v": 0
}
```


### 5. Get Expenses List

- **URL:** `http://localhost:3000/api/expenses/expenseslist`
- **Method:** `GET`
- **Content-Type:** `application/json`

#### Request Body

The request body should be a JSON object with the following structure:

```json
{
  "Header": {
    "token": "<USER TOKEN>"
  }
}
```
Success Response
Code: 200 OK

Content:

```json
[
  {
    "_id": "<EXPENSE ID>",
    "ownedBy": "you",
    "expensesName": "expense name",
    "description": "description"
  }
]
```

### 6. Get Expense by ID

- **URL:** `http://localhost:3000/api/expenses/expenseslist?id=<expense_id>`
- **Method:** `GET`
- **Content-Type:** `application/json`

#### Request Body

The request body should be a JSON object with the following structure:

```json
{
  "Header": {
    "token": "<USER TOKEN>"
  }
}
```
Success Response
Code: 200 OK

Content:

```json

{
  "_id": "<EXPENSE ID>",
  "payerEmail": "user@example.com",
  "expensesName": "weekend getaway",
  "totalAmount": 600,
  "splitType": "exact",
  "description": "outing with friends",
  "participants": [
    {
      "email": "friend1@example.com",
      "amount": 200,
      "_id": "<PARTICIPANT ID>"
    }
  ],
  "upDateEnteries": [
    {
      "enteries": {
        "belongsTo": "<EXPENSE ID>",
        "addedby": "user@example.com",
        "thisTimeTotal": 600,
        "data": [
          {
            "email": "friend1@example.com",
            "amount": 200,
            "_id": "<ENTRY ID>"
          }
        ]
      },
      "_id": "<ENTRY ID>",
      "__v": 0
    }
  ],
  "__v": 0
}
```
  
